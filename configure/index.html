<!DOCTYPE html>
<html> 
  <head> 
    <title>Watchbot Configuration</title> 
    <meta charset="utf-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css" />
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>    
  </head> 
  <style> body, textarea, button { font-size: 20px; font-family: monospace; text-align: center; } textarea { resize: none; padding-top: 15px; } button { padding: 15px; } 
  </style> 
  <body> 
    <div data-role="page" id="main"> 
      <div data-role="header" class="jqm-header"> 
        <h1>Configure watchbot</h1> 
      </div> 
      <div data-role="content"> 
        <div data-role="fieldcontain"> 
          <label for="name">Robot name is:</label> 
          <textarea cols="24" name="name" id="name"></textarea> 
        </div> 
        <div data-role="fieldcontain"> 
          <label for="host">Robot API host:</label> 
          <textarea cols="24" name="host" id="host"></textarea> 
        </div> 
        <div data-role="fieldcontain"> 
          <label for="port">Robot API port:</label> 
          <textarea cols="24" name="port" id="port"></textarea> 
        </div> 
        <div data-role="fieldcontain"> 
          <label for="device">Robot API device:</label> 
          <textarea cols="24" name="device" id="device"></textarea> 
        </div>
        <br/> 
        <div class="ui-body ui-body-b"> 
          <button type="submit" data-theme="c" id="b-cancel">Cancel</button>
          <button type="submit" data-theme="a" id="b-submit">Submit</button>
        </div> 
      </div> 
    </div> 
    <script> 
      function saveOptions() { 
        "use strict"; 
        var options = { 
          "name":    document.getElementById("name").value, 
          "host":    document.getElementById("host").value, 
          "port":    document.getElementById("port").value, 
          "device":  document.getElementById("device").value 
        }; 
        return options; 
      } 

      $().ready(function() {
        $("#b-cancel").click(function() {
          document.location = "pebblejs://close#" + encodeURIComponent(JSON.stringify({canceled:true}));
        });
        $("#b-submit").click(function() {
          var location = "pebblejs://close#" + encodeURIComponent(JSON.stringify(saveOptions()));
          document.location = location;
        });
        
        //Set form values to whatever is passed in.
        var params = window.location.search.substring(1);
        if(params.length > 0){
          var obj = jQuery.parseJSON(decodeURIComponent(window.location.search.substring(1)));
          for(key in obj) {
            $("#"+[key]).val(obj[key]);
          }
        }
      });
    </script> 
  </body> 
</html>
